// Copyright (C) 2021 Charles All rights reserved.
// Author: @Charles-1414
// License: GNU General Public License v3.0

$("head").prepend("<style> @font-face { font-family: 'Comic Sans MS'; src: url('/static/ComicSansMS3.ttf') format('truetype'); } </style>");var canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d"),isphone=0;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(isphone=1);var fontsize=40,smallfontsize=20,largefontsize=60,btnMargin=.5,lineheight=50,bottomOffset=100,b=[],btncnt=8;isphone?(fontsize=80,smallfontsize=40,largefontsize=120,btnMargin=.2,lineheight=100,bottomOffset=250,b[0]={name:"submit",x:0,y:0,w:600,h:100},b[1]={name:"home",x:0,y:0,w:400,h:100},b[2]={name:"logout",x:0,y:0,w:400,h:100},b[3]={name:"switchToRegister",x:0,y:0,w:200,h:50},b[4]={name:"switchToLogin",x:0,y:0,w:200,h:50},b[5]={name:"deleteacc",x:0,y:0,w:800,h:100},b[6]={name:"settings",x:0,y:0,w:400,h:100},b[7]={name:"changepwd",x:0,y:0,w:800,h:100}):(b[0]={name:"submit",x:0,y:0,w:300,h:50},b[1]={name:"home",x:0,y:0,w:200,h:50},b[2]={name:"logout",x:0,y:0,w:200,h:50},b[3]={name:"switchToRegister",x:0,y:0,w:100,h:25},b[4]={name:"switchToLogin",x:0,y:0,w:100,h:25},b[5]={name:"deleteacc",x:0,y:0,w:400,h:50},b[6]={name:"settings",x:0,y:0,w:200,h:50},b[7]={name:"changepwd",x:0,y:0,w:400,h:50});var currentpage=0,username="",email="",invitationCode="",inviter="",cnt=0,tagcnt=0,delcnt=0,chcnt=0;function btninit(){for(var t=0;t<btncnt;t++)b[t].x=canvas.width+5000,b[t].y=canvas.height+5000}function drawHomePage(){btninit(),canvas.width=document.body.clientWidth,canvas.height=document.body.clientHeight,ctx.clearRect(0,0,canvas.width,canvas.height),ctx.font=largefontsize+"px Comic Sans MS",ctx.fillStyle=getRndColor(10,100),ctx.textAlign="center",ctx.fillText("Word Memo",canvas.width/2,canvas.height/2-250),ctx.font=fontsize+"px Comic Sans MS",ctx.fillText("User Information",canvas.width/2,canvas.height/2-180),b[1].x=.2*b[1].w,b[1].y=.2*b[1].h,ctx.fillStyle=getRndColor(160,250),ctx.roundRect(b[1].x,b[1].y,b[1].w,b[1].h),ctx.font=fontsize+"px Comic Sans MS",ctx.fillStyle=getRndColor(10,100),ctx.fillText("Home",b[1].x+b[1].w/2,b[1].y+b[1].h/1.4),b[2].x=canvas.width-1.2*b[2].w,b[2].y=.2*b[2].h,ctx.fillStyle=getRndColor(160,250),ctx.roundRect(b[2].x,b[2].y,b[2].w,b[2].h),ctx.font=fontsize+"px Comic Sans MS",ctx.fillStyle=getRndColor(10,100),ctx.fillText("Logout",b[2].x+b[2].w/2,b[2].y+b[2].h/1.4),b[6].x=canvas.width-1.2*b[6].w,b[6].y=1.5*b[6].h,ctx.fillStyle=getRndColor(160,250),ctx.roundRect(b[6].x,b[6].y,b[6].w,b[6].h),ctx.font=.9*fontsize+"px Comic Sans MS",ctx.fillStyle=getRndColor(10,100),ctx.textAlign="center",ctx.fillText("Settings",b[6].x+b[6].w/2,b[6].y+b[6].h/1.4),ctx.font=fontsize+"px Comic Sans MS",ctx.fillText("User ID: "+localStorage.getItem("userId"),canvas.width/2,canvas.height/2-100),""==username&&$.ajax({url:"/api/getUserInfo",method:"POST",async:!1,dataType:"json",data:{userId:localStorage.getItem("userId"),token:localStorage.getItem("token")},success:function(t){username=t.username,email=t.email,invitationCode=t.invitationCode,cnt=t.cnt,tagcnt=t.tagcnt,delcnt=t.delcnt,chcnt=t.chcnt,inviter=t.inviter}}),ctx.font=fontsize+"px Comic Sans MS",ctx.fillText("Username: "+username,canvas.width/2,canvas.height/2-50),ctx.font=fontsize+"px Comic Sans MS",ctx.fillText("Email: "+email,canvas.width/2,canvas.height/2),ctx.font=fontsize+"px Comic Sans MS",ctx.fillText("Invitation Code: "+invitationCode,canvas.width/2,canvas.height/2+50),ctx.font=fontsize+"px Comic Sans MS",ctx.fillText("Invited By: "+inviter,canvas.width/2,canvas.height/2+100),ctx.font=fontsize+"px Comic Sans MS",ctx.fillText(cnt+" words in list",canvas.width/2,canvas.height/2+170),ctx.font=fontsize+"px Comic Sans MS",ctx.fillText(tagcnt+" tagged and "+delcnt+" deleted",canvas.width/2,canvas.height/2+220),ctx.font=fontsize+"px Comic Sans MS",ctx.fillText(chcnt+" challenges done so far",canvas.width/2,canvas.height/2+270)}function drawLoginPage(){btninit(),canvas.width=document.body.clientWidth,canvas.height=document.body.clientHeight,ctx.clearRect(0,0,canvas.width,canvas.height),ctx.font=largefontsize+"px Comic Sans MS",ctx.fillStyle=getRndColor(10,100),ctx.textAlign="center",ctx.fillText("Word Memo",canvas.width/2,canvas.height/2-200),ctx.font=fontsize+"px Comic Sans MS",ctx.fillText("Login",canvas.width/2,canvas.height/2-130),ctx.font=fontsize+"px Comic Sans MS",ctx.fillStyle=getRndColor(10,100),ctx.textAlign="center",ctx.fillText("Username: ",canvas.width/2-b[0].w/2,canvas.height/2-30),$("#username").attr("style","position:absolute;left:"+(canvas.width/2+b[0].w/4)+";top:"+(canvas.height/2-48)+";font-size:"+.4*fontsize+";font-family:Comic Sans MS"),ctx.fillText("Password: ",canvas.width/2-b[0].w/2,canvas.height/2+20),$("#password").attr("style","position:absolute;left:"+(canvas.width/2+b[0].w/4)+";top:"+(canvas.height/2+2)+";font-size:"+.4*fontsize+";font-family:Comic Sans MS"),$("#email").hide(),$("#invitationCode").hide(),b[1].x=.2*b[1].w,b[1].y=.2*b[1].h,ctx.fillStyle=getRndColor(160,250),ctx.roundRect(b[1].x,b[1].y,b[1].w,b[1].h),ctx.font=fontsize+"px Comic Sans MS",ctx.fillStyle=getRndColor(10,100),ctx.fillText("Home",b[1].x+b[1].w/2,b[1].y+b[1].h/1.4),b[0].x=canvas.width/2-b[0].w/2,b[0].y=canvas.height/2+2*b[0].h,ctx.fillStyle=getRndColor(160,250),ctx.roundRect(b[0].x,b[0].y,b[0].w,b[0].h),ctx.font=fontsize+"px Comic Sans MS",ctx.fillStyle=getRndColor(10,100),ctx.textAlign="center",ctx.fillText("Login",b[0].x+b[0].w/2,b[0].y+b[0].h/1.4),b[3].x=canvas.width/2+b[3].w/2,b[3].y=canvas.height/2-120,ctx.font=smallfontsize+"px Comic Sans MS",ctx.fillStyle=getRndColor(10,100),ctx.textAlign="left",ctx.fillText("Register",b[3].x+b[3].w/2,b[3].y+b[3].h/1.4),ctx.font=fontsize+"px Comic Sans MS",ctx.textAlign="center"}function drawRegisterPage(){btninit(),canvas.width=document.body.clientWidth,canvas.height=document.body.clientHeight,ctx.clearRect(0,0,canvas.width,canvas.height),ctx.font=largefontsize+"px Comic Sans MS",ctx.fillStyle=getRndColor(10,100),ctx.textAlign="center",ctx.fillText("Word Memo",canvas.width/2,canvas.height/2-200),ctx.font=fontsize+"px Comic Sans MS",ctx.fillText("Register",canvas.width/2,canvas.height/2-130),ctx.font=fontsize+"px Comic Sans MS",ctx.fillStyle=getRndColor(10,100),ctx.textAlign="center",ctx.fillText("Username: ",canvas.width/2-b[0].w/2,canvas.height/2-30),$("#username").attr("style","position:absolute;left:"+(canvas.width/2+b[0].w/4)+";top:"+(canvas.height/2-48)+";font-size:"+.4*fontsize+";font-family:Comic Sans MS"),ctx.fillText("Email: ",canvas.width/2-b[0].w/2,canvas.height/2+20),$("#email").attr("style","position:absolute;left:"+(canvas.width/2+b[0].w/4)+";top:"+(canvas.height/2+2)+";font-size:"+.4*fontsize+";font-family:Comic Sans MS"),ctx.fillText("Password: ",canvas.width/2-b[0].w/2,canvas.height/2+70),$("#password").attr("style","position:absolute;left:"+(canvas.width/2+b[0].w/4)+";top:"+(canvas.height/2+52)+";font-size:"+.4*fontsize+";font-family:Comic Sans MS"),ctx.fillText("Invitation code: ",canvas.width/2-b[0].w/2,canvas.height/2+120),$("#invitationCode").attr("style","position:absolute;left:"+(canvas.width/2+b[0].w/4)+";top:"+(canvas.height/2+102)+";font-size:"+.4*fontsize+";font-family:Comic Sans MS"),b[1].x=.2*b[1].w,b[1].y=.2*b[1].h,ctx.fillStyle=getRndColor(160,250),ctx.roundRect(b[1].x,b[1].y,b[1].w,b[1].h),ctx.font=fontsize+"px Comic Sans MS",ctx.fillStyle=getRndColor(10,100),ctx.fillText("Home",b[1].x+b[1].w/2,b[1].y+b[1].h/1.4),b[0].x=canvas.width/2-b[0].w/2,b[0].y=canvas.height/2+4*b[0].h,ctx.fillStyle=getRndColor(160,250),ctx.roundRect(b[0].x,b[0].y,b[0].w,b[0].h),ctx.font=fontsize+"px Comic Sans MS",ctx.fillStyle=getRndColor(10,100),ctx.textAlign="center",ctx.fillText("Register",b[0].x+b[0].w/2,b[0].y+b[0].h/1.4),b[4].x=canvas.width/2+b[4].w/2,b[4].y=canvas.height/2-120,ctx.font=smallfontsize+"px Comic Sans MS",ctx.fillStyle=getRndColor(10,100),ctx.textAlign="left",ctx.fillText("Login",b[4].x+b[4].w/2,b[4].y+b[4].h/1.4),ctx.font=fontsize+"px Comic Sans MS",ctx.textAlign="center"}function drawSettings(){$("#oldpwd").hide(),$("#newpwd").hide(),$("#cfmpwd").hide(),btninit(),canvas.width=document.body.clientWidth,canvas.height=document.body.clientHeight,ctx.clearRect(0,0,canvas.width,canvas.height),b[1].x=.2*b[1].w,b[1].y=.2*b[1].h,ctx.fillStyle=getRndColor(160,250),ctx.roundRect(b[1].x,b[1].y,b[1].w,b[1].h),ctx.font=fontsize+"px Comic Sans MS",ctx.fillStyle=getRndColor(10,100),ctx.textAlign="center",ctx.fillText("Back",b[1].x+b[1].w/2,b[1].y+b[1].h/1.4),b[7].x=canvas.width/2-b[7].w/2,b[7].y=canvas.height/2,ctx.fillStyle=getRndColor(160,250),ctx.roundRect(b[7].x,b[7].y,b[7].w,b[7].h),ctx.font=fontsize+"px Comic Sans MS",ctx.fillStyle=getRndColor(10,100),ctx.fillText("Change Password",b[7].x+b[7].w/2,b[7].y+b[7].h/1.4),b[5].x=canvas.width/2-b[5].w/2,b[5].y=3*canvas.height/4,ctx.fillStyle=getRndColor(160,250),ctx.roundRect(b[5].x,b[5].y,b[5].w,b[5].h),ctx.font=fontsize+"px Comic Sans MS",ctx.fillStyle=getRndColor(10,100),ctx.fillText("Delete Account",b[5].x+b[5].w/2,b[5].y+b[5].h/1.4),ctx.font=fontsize+"px Comic Sans MS",ctx.fillStyle=getRndColor(10,100),ctx.textAlign="center",ctx.fillText("Account settings",canvas.width/2,.2*b[1].h+b[1].h/1.4)}function drawChangepwd(){btninit(),canvas.width=document.body.clientWidth,canvas.height=document.body.clientHeight,ctx.clearRect(0,0,canvas.width,canvas.height),b[1].x=.2*b[1].w,b[1].y=.2*b[1].h,ctx.fillStyle=getRndColor(160,250),ctx.roundRect(b[1].x,b[1].y,b[1].w,b[1].h),ctx.font=fontsize+"px Comic Sans MS",ctx.fillStyle=getRndColor(10,100),ctx.textAlign="center",ctx.fillText("Back",b[1].x+b[1].w/2,b[1].y+b[1].h/1.4),b[0].x=canvas.width/2-b[0].w/2,b[0].y=canvas.height/2+4*b[0].h,ctx.fillStyle=getRndColor(160,250),ctx.roundRect(b[0].x,b[0].y,b[0].w,b[0].h),ctx.font=fontsize+"px Comic Sans MS",ctx.fillStyle=getRndColor(10,100),ctx.textAlign="center",ctx.fillText("Change",b[0].x+b[0].w/2,b[0].y+b[0].h/1.4),ctx.font=fontsize+"px Comic Sans MS",ctx.fillStyle=getRndColor(10,100),ctx.textAlign="center",ctx.fillText("Old password: ",canvas.width/2-b[0].w/2,canvas.height/2-30),$("#oldpwd").attr("style","position:absolute;left:"+(canvas.width/2+b[0].w/4)+";top:"+(canvas.height/2-48)+";font-size:"+.4*fontsize+";font-family:Comic Sans MS"),ctx.fillText("New password: ",canvas.width/2-b[0].w/2,canvas.height/2+20),$("#newpwd").attr("style","position:absolute;left:"+(canvas.width/2+b[0].w/4)+";top:"+(canvas.height/2+2)+";font-size:"+.4*fontsize+";font-family:Comic Sans MS"),ctx.fillText("Confirm password: ",canvas.width/2-b[0].w/2,canvas.height/2+70),$("#cfmpwd").attr("style","position:absolute;left:"+(canvas.width/2+b[0].w/4)+";top:"+(canvas.height/2+52)+";font-size:"+.4*fontsize+";font-family:Comic Sans MS"),ctx.font=fontsize+"px Comic Sans MS",ctx.fillStyle=getRndColor(10,100),ctx.textAlign="center",ctx.fillText("Change Password",canvas.width/2,.2*b[1].h+b[1].h/1.4)}function drawDeleteacc(){btninit(),canvas.width=document.body.clientWidth,canvas.height=document.body.clientHeight,ctx.clearRect(0,0,canvas.width,canvas.height),b[1].x=.2*b[1].w,b[1].y=.2*b[1].h,ctx.fillStyle=getRndColor(160,250),ctx.roundRect(b[1].x,b[1].y,b[1].w,b[1].h),ctx.font=fontsize+"px Comic Sans MS",ctx.fillStyle=getRndColor(10,100),ctx.textAlign="center",ctx.fillText("Back",b[1].x+b[1].w/2,b[1].y+b[1].h/1.4),b[0].x=canvas.width/2-b[0].w/2,b[0].y=canvas.height/2+2*b[0].h,ctx.fillStyle=getRndColor(160,250),ctx.roundRect(b[0].x,b[0].y,b[0].w,b[0].h),ctx.font=fontsize+"px Comic Sans MS",ctx.fillStyle=getRndColor(10,100),ctx.textAlign="center",ctx.fillText("Delete",b[0].x+b[0].w/2,b[0].y+b[0].h/1.4),ctx.font=fontsize+"px Comic Sans MS",ctx.fillStyle=getRndColor(10,100),ctx.textAlign="center",ctx.fillText("Password: ",canvas.width/2-b[0].w/2,canvas.height/2-30),$("#password").attr("style","position:absolute;left:"+(canvas.width/2+b[0].w/4)+";top:"+(canvas.height/2-48)+";font-size:"+.4*fontsize+";font-family:Comic Sans MS"),ctx.font=fontsize+"px Comic Sans MS",ctx.fillStyle=getRndColor(10,100),ctx.textAlign="center",ctx.fillText("Delete Account",canvas.width/2,.2*b[1].h+b[1].h/1.4),ctx.font=smallfontsize+"px Comic Sans MS",ctx.fillText("* Your account will be deleted after 14 days.",canvas.width/2,b[0].y+1.75*b[0].h),ctx.fillText("You can recover it by logging in during that period.",canvas.width/2,b[0].y+2.25*b[0].h),ctx.fillText("After 14 days it will be deleted permanently and cannot be recovered.",canvas.width/2,b[0].y+2.75*b[0].h)}$.ajax({url:"/api/getUserInfo",method:"POST",async:!0,dataType:"json",data:{userId:localStorage.getItem("userId"),token:localStorage.getItem("token")},success:function(t){username=t.username,email=t.email,invitationCode=t.invitationCode,cnt=t.cnt,tagcnt=t.tagcnt,delcnt=t.delcnt,chcnt=t.chcnt,inviter=t.inviter}}),userId=localStorage.getItem("userId"),token=localStorage.getItem("token");var validation=!1;function drawCurrentPage(){sleep(50).then(()=>{0==currentpage?drawHomePage():1==currentpage?drawLoginPage():2==currentpage?drawRegisterPage():3==currentpage?drawSettings():4==currentpage?drawChangepwd():5==currentpage&&drawDeleteacc()})}function loginfunc(){if(username=$("#username").val(),password=$("#password").val(),ctx.fillStyle="white",ctx.roundRect(0,b[0].y-1.5*b[0].h-5,canvas.width,b[0].h+20),""==username||""==password)return ctx.fillStyle="red",void ctx.fillText("Both fields must be filled!",canvas.width/2,b[0].y-.5*b[0].h);$.ajax({url:"/api/login",method:"POST",async:!1,dataType:"json",data:{username:username,password:password},success:function(t){1==t.success?(localStorage.setItem("userId",t.userId),localStorage.setItem("token",t.token),ctx.fillStyle="green",ctx.fillText("Logged in successfully!",canvas.width/2,b[0].y-.5*b[0].h),$.ajax({url:"/api/getUserInfo",method:"POST",async:!0,dataType:"json",data:{userId:localStorage.getItem("userId"),token:localStorage.getItem("token")},success:function(t){username=t.username,email=t.email,invitationCode=t.invitationCode,cnt=t.cnt,tagcnt=t.tagcnt,delcnt=t.delcnt,chcnt=t.chcnt,inviter=t.inviter}}),sleep(2e3).then(()=>{$("#username").hide(),$("#password").hide(),$("#username").val(""),$("#password").val(""),currentpage=0,drawCurrentPage()})):(ctx.fillStyle="red",ctx.fillText(t.msg,canvas.width/2,b[0].y-.5*b[0].h))}})}function registerfunc(){if(username=$("#username").val(),password=$("#password").val(),email=$("#email").val(),invitationCode=$("#invitationCode").val(),ctx.fillStyle="white",ctx.roundRect(0,b[0].y-1.5*b[0].h-5,canvas.width,b[0].h+20),""==username||""==password||""==email||""==invitationCode)return ctx.fillStyle="red",void ctx.fillText("All fields must be filled!",canvas.width/2,b[0].y-.5*b[0].h);$.ajax({url:"/api/register",method:"POST",async:!1,dataType:"json",data:{username:username,password:password,email:email,invitationCode:invitationCode},success:function(t){1==t.success?(ctx.fillStyle="green",ctx.fillText("Registered successfully!",canvas.width/2,b[0].y-.5*b[0].h),sleep(2e3).then(()=>{$("#email").hide(),$("#invitationCode").hide(),$("#email").val(""),$("#invitationCode").val(""),currentpage=1,drawCurrentPage()})):(ctx.fillStyle="red",ctx.fillText(t.msg,canvas.width/2,b[0].y-.5*b[0].h))}})}function changepwdfunc(){if(oldpwd=$("#oldpwd").val(),newpwd=$("#newpwd").val(),cfmpwd=$("#cfmpwd").val(),ctx.fillStyle="white",ctx.roundRect(0,b[0].y-1.5*b[0].h-5,canvas.width,b[0].h+20),""==oldpwd||""==newpwd||""==cfmpwd)return ctx.fillStyle="red",void ctx.fillText("All fields must be filled!",canvas.width/2,b[0].y-.5*b[0].h);$.ajax({url:"/api/changePassword",method:"POST",async:!1,dataType:"json",data:{oldpwd:oldpwd,newpwd:newpwd,cfmpwd:cfmpwd,userId:localStorage.getItem("userId"),token:localStorage.getItem("token")},success:function(t){1==t.success?($("#oldpwd").hide(),$("#newpwd").hide(),$("#cfmpwd").hide(),$("#oldpwd").val(""),$("#newpwd").val(""),$("#cfmpwd").val(""),ctx.fillStyle="green",localStorage.removeItem("userid"),localStorage.removeItem("token"),currentpage=1,drawCurrentPage(),sleep(100).then(()=>{ctx.fillStyle="green",ctx.fillText("Password changed successfully!",canvas.width/2,b[0].y-.5*b[0].h)})):(ctx.fillStyle="red",ctx.fillText(t.msg,canvas.width/2,b[0].y-.5*b[0].h))}})}function deleteaccfunc(){if(password=$("#password").val(),ctx.font=fontsize+"px Comic Sans MS",ctx.fillStyle="white",ctx.roundRect(0,b[0].y-1.5*b[0].h-5,canvas.width,b[0].h+20),""==password)return ctx.fillStyle="red",void ctx.fillText("You must enter your password!",canvas.width/2,b[0].y-.5*b[0].h);$.ajax({url:"/api/deleteAccount",method:"POST",async:!1,dataType:"json",data:{password:password,userId:localStorage.getItem("userId"),token:localStorage.getItem("token")},success:function(t){1==t.success?($("#password").hide(),$("#password").val(""),ctx.fillStyle="green",localStorage.removeItem("userid"),localStorage.removeItem("token"),currentpage=1,drawCurrentPage(),sleep(100).then(()=>{ctx.fillStyle="green",ctx.fillText("Accounted marked for deletion!",canvas.width/2,b[0].y-.5*b[0].h)})):(ctx.fillStyle="red",ctx.fillText(t.msg,canvas.width/2,b[0].y-.5*b[0].h))}})}function clickHandler(t){for(var n=t.clientX-canvas.offsetLeft,e=t.clientY-canvas.offsetTop,o=0;o<btncnt;o++)n>=b[o].x&&n<=b[o].x+b[o].w&&e>=b[o].y&&e<=b[o].y+b[o].h&&(1,console.log(b[o].name+" button triggered"),"submit"==b[o].name?1==currentpage?loginfunc():2==currentpage?registerfunc():4==currentpage?changepwdfunc():5==currentpage&&deleteaccfunc():"home"==b[o].name?currentpage<3?window.location.href="/":3==currentpage?(currentpage=0,drawCurrentPage()):4!=currentpage&&5!=currentpage||(currentpage=3,drawCurrentPage()):"switchToRegister"==b[o].name?(currentpage=2,drawCurrentPage()):"switchToLogin"==b[o].name?(currentpage=1,drawCurrentPage()):"settings"==b[o].name?(currentpage=3,drawCurrentPage()):"changepwd"==b[o].name?(currentpage=4,drawCurrentPage()):"deleteacc"==b[o].name?(currentpage=5,drawCurrentPage()):"logout"==b[o].name&&($.ajax({url:"/api/logout",method:"POST",async:!0,dataType:"json",data:{userId:localStorage.getItem("userId"),token:localStorage.getItem("token")}}),localStorage.removeItem("userid"),localStorage.removeItem("token"),currentpage=1,drawCurrentPage(),sleep(100).then(()=>{ctx.fillStyle="green",ctx.fillText("Loggod out successfully!",canvas.width/2,b[0].y-.5*b[0].h)})))}$.ajax({url:"/api/validateToken",method:"POST",async:!1,dataType:"json",data:{userId:localStorage.getItem("userId"),token:localStorage.getItem("token")},success:function(t){validation=t.validation}}),0==validation?(drawLoginPage(),currentpage=1):(drawHomePage(),currentpage=0),isphone||(window.onresize=drawCurrentPage),$("#password").on("keypress",function(t){13==t.which&&(1==currentpage?loginfunc():2==currentpage?registerfunc():5==currentpage&&deleteaccfunc())}),$("#cfmpwd").on("keypress",function(t){changepwdfunc()}),document.addEventListener("click",clickHandler,!1);