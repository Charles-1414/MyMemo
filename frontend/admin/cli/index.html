<script src="/js/jquery-3.6.0.min.js"></script>
<title>Word Memo - CLI Admin</title>

<h1>Word Memo</h1>
<h2>Command Line Interface Admin Panel</h1>
<input type="text" id="command" style="width:400px" />
<input type="submit" id="submit" value="Submit" />
<p>Output: </p>
<p><span id="output"></span></p>
<br>
<h2>Command List</h2>
<p>User Management</p>
<p>1. get_user_info [userId] - Get detailed user info of [userId]</p>
<p>2. create_user [username] [email] [password] - Create a user by admin, user will be shown as invited by this admin</p>
<p>3. delete_user [userId] - The account must be marked as deletion first, and admin will be able to bring the deletion schedule forward</p>
<p>4. set_previlege [userId] [item] [value] - Add [item] previlege for user [userId] ([item] can be word_limit, word_book_limit, allow_group_creation, group_member_limit) | If previlege exists, then update it</p>
<p>5. remove_previlege [userId] [item] - Delete [item] previlege from user [userId]</p>
<p>6. ban_account [userId] - Ban account</p>
<p>7. unban_account [userId] - Unban account</p>
<p>8. get_user_count - Get user count</p>
<script>
    $(document).ready(function () {
        $.ajax({
            url: "/api/admin/command",
            method: 'POST',
            async: false,
            dataType: "json",
            data: {
                userId: localStorage.getItem("userId"),
                token: localStorage.getItem("token"),
                command: "check_admin"
            },
            error: function (r, textStatus, errorThrown) {
                window.location.href = "/";
            }
        });

        function submitCommand() {
            $("#output").attr("style", "color:gray");
            $("#output").html("Running...");
            $.ajax({
                url: "/api/admin/command",
                method: 'POST',
                async: false,
                dataType: "json",
                data: {
                    userId: localStorage.getItem("userId"),
                    token: localStorage.getItem("token"),
                    command: $("#command").val()
                },
                success: function (r) {
                    if (r.success == true) {
                        $("#output").attr("style", "color:green");
                    } else if (r.success == false) {
                        $("#output").attr("style", "color:red");
                    }
                    $("#output").html(r.msg.replaceAll("\n", "<br>"));
                },
                error: function (r, textStatus, errorThrown) {
                    if (r.status == 401) {
                        alert("Login session expired! Please login again!");
                        localStorage.removeItem("userId");
                        localStorage.removeItem("token");
                        window.location.href = "/user";
                    } else {
                        $("#output").attr("style", "color:gray");
                        $("#output").html("Error " + r.status + " " + errorThrown);
                    }
                }
            });
        }
        $(document).on('keydown', function (e) {
            if (e.which == 13) {
                submitCommand();
            }
        });
        $("#submit").click(function () {
            submitCommand();
        });
    });
</script>

<style>
    .footer {
        z-index: -1; 
        position: fixed;
        right: 10;
        bottom: 0;
        width: 100%;
        text-align: right;
        font-family: Corbel;
    }
</style>
<div class="footer">
    <p>v5.1.1 &copy; Charles</p>
    <p>Contact: <a href="mailto:word@charles14.xyz">word@charles14.xyz</a></p>
</div>