function BackToHome(){window.location.href="/"}function GoToUser(){window.location.href="/user"}function Login(){username=$("#input-username").val(),password=$("#input-password").val(),""!=username&&""!=password?$.ajax({url:"/api/user/login",method:"POST",async:!1,dataType:"json",data:{username:username,password:password},success:function(e){1==e.success?(localStorage.setItem("userId",e.userId),localStorage.setItem("token",e.token),user.userId=e.userId,new Noty({theme:"mint",text:"Success! You have now logged in!",type:"success",layout:"bottomRight",timeout:3e3}).show(),$.ajax({url:"/api/user/info",method:"POST",async:!0,dataType:"json",data:{userId:localStorage.getItem("userId"),token:localStorage.getItem("token")},success:function(e){user.username=e.username,user.email=e.email,user.invitationCode=e.invitationCode,user.cnt=e.cnt,user.tagcnt=e.tagcnt,user.delcnt=e.delcnt,user.chcnt=e.chcnt,user.inviter=e.inviter,user.age=e.age,user.isAdmin=e.isAdmin}}),$("#input-username").val(""),$("#input-password").val(""),window.location.reload()):new Noty({theme:"mint",text:e.msg,type:"error",layout:"bottomRight",timeout:3e3}).show()}}):new Noty({theme:"mint",text:"Both fields must be filled!",type:"warning",layout:"bottomRight",timeout:3e3}).show()}function Register(){username=$("#register-username").val(),password=$("#register-password").val(),email=$("#register-email").val(),invitationCode=$("#register-inviteCode").val(),""!=username&&""!=password&&""!=email&&""!=invitationCode?$.ajax({url:"/api/user/register",method:"POST",async:!1,dataType:"json",data:{username:username,password:password,email:email,invitationCode:invitationCode},success:function(e){1==e.success?(new Noty({theme:"mint",text:"Success! You are now registered!",type:"success",layout:"bottomRight",timeout:3e3}).show(),$(".register").hide(),$(".login").show(),$("#register-password").val("")):new Noty({theme:"mint",text:e.msg,type:"error",layout:"bottomRight",timeout:3e3}).show()}}):new Noty({theme:"mint",text:"All fields must be filled!",type:"warning",layout:"bottomRight",timeout:3e3}).show()}function SignOut(){$.ajax({url:"/api/user/logout",method:"POST",async:!0,dataType:"json",data:{userId:localStorage.getItem("userId"),token:localStorage.getItem("token")}}),localStorage.removeItem("userid"),localStorage.removeItem("username"),localStorage.removeItem("token"),$(".user").hide(),$(".login").show(),new Noty({theme:"mint",text:"Success! You are now signed out!",type:"success",layout:"bottomRight",timeout:3e3}).show()}function UpdateProfileShow(){$("#updateProfileModal").modal("toggle"),$("#update-username").val(user.username),$("#update-email").val(user.email)}function UpdateUserProfile(){username=$("#update-username").val(),email=$("#update-email").val(),""!=username&&""!=email?$.ajax({url:"/api/user/updateInfo",method:"POST",async:!1,dataType:"json",data:{username:username,email:email,userId:localStorage.getItem("userId"),token:localStorage.getItem("token")},success:function(e){1==e.success?(user.username=username,user.email=email,$("#username").html(user.username),$("#email").html(user.email),$("#updateProfileModal").modal("toggle"),new Noty({theme:"mint",text:e.msg,type:"success",layout:"bottomRight",timeout:3e3}).show()):new Noty({theme:"mint",text:e.msg,type:"error",layout:"bottomRight",timeout:3e3}).show()}}):new Noty({theme:"mint",text:"Both fields must be filled!",type:"warning",layout:"bottomRight",timeout:3e3}).show()}function ChangePassword(){oldpwd=$("#oldpwd").val(),newpwd=$("#newpwd").val(),cfmpwd=$("#cfmpwd").val(),""!=oldpwd&&""!=newpwd&&""!=cfmpwd?$.ajax({url:"/api/user/changePassword",method:"POST",async:!1,dataType:"json",data:{oldpwd:oldpwd,newpwd:newpwd,cfmpwd:cfmpwd,userId:localStorage.getItem("userId"),token:localStorage.getItem("token")},success:function(e){1==e.success?($("#oldpwd").val(""),$("#newpwd").val(""),$("#cfmpwd").val(""),new Noty({theme:"mint",text:"Success! Password has been changed! You have to log in again!",type:"success",layout:"bottomRight",timeout:3e3}).show(),$("#changePasswordModal").modal("toggle"),localStorage.removeItem("userid"),localStorage.removeItem("username"),localStorage.removeItem("token"),$(".user").hide(),$(".login").show()):new Noty({theme:"mint",text:e.msg,type:"error",layout:"bottomRight",timeout:3e3}).show()}}):new Noty({theme:"mint",text:"All fields must be filled!",type:"warning",layout:"bottomRight",timeout:3e3}).show()}function ChangePasswordShow(){$("#changePasswordModal").modal("toggle")}function DeleteAccount(){ack=$("#acknowledge-confirm").val(),password=$("#delete-password").val(),"I acknowledge what I'm doing"==ack?""!=password?$.ajax({url:"/api/user/delete",method:"POST",async:!1,dataType:"json",data:{password:password,userId:localStorage.getItem("userId"),token:localStorage.getItem("token")},success:function(e){1==e.success?($("#delete-password").val(""),new Noty({theme:"mint",text:"Account disabled! It will be deleted after 14 days!",type:"warning",layout:"bottomRight",timeout:1e4}).show(),$("#deleteAccountModal").modal("toggle"),localStorage.removeItem("userid"),localStorage.removeItem("username"),localStorage.removeItem("token"),$(".user").hide(),$(".login").show()):new Noty({theme:"mint",text:e.msg,type:"error",layout:"bottomRight",timeout:3e3}).show()}}):new Noty({theme:"mint",text:"Enter your password!",type:"warning",layout:"bottomRight",timeout:3e3}).show():new Noty({theme:"mint",text:'Type "I acknowledge what I\'m doing" in the first input box to continue!',type:"warning",layout:"bottomRight",timeout:3e3}).show()}function DeleteAccountShow(){$("#deleteAccountModal").modal("toggle")}function RestartServer(){user.isAdmin&&$.ajax({url:"/api/admin/restart",method:"POST",async:!0,dataType:"json",data:{userId:localStorage.getItem("userId"),token:localStorage.getItem("token")},success:function(e){0==e.success?new Noty({theme:"mint",text:e.msg,type:"error",layout:"bottomRight",timeout:3e3}).show():new Noty({theme:"mint",text:"Server is being restarted!",type:"success",layout:"bottomRight",timeout:3e3}).show()},error:function(e,t,o){401==e.status?SessionExpired():new Noty({theme:"mint",text:"Error: "+e.status+" "+o,type:"error",layout:"bottomRight",timeout:1e4}).show()}})}class UserClass{constructor(){this.userId=-1,this.username="",this.email="",this.invitationCode="",this.cnt=0,this.tagcnt=0,this.delcnt=0,this.chcnt=0,this.inviter=-1,this.age=0,this.isAdmin=!1}}user=new UserClass,$("#signout-btn").hide(),$.ajax({url:"/api/user/info",method:"POST",async:!0,dataType:"json",data:{userId:localStorage.getItem("userId"),token:localStorage.getItem("token")},success:function(e){user.username=e.username,user.email=e.email,user.invitationCode=e.invitationCode,user.cnt=e.cnt,user.tagcnt=e.tagcnt,user.delcnt=e.delcnt,user.chcnt=e.chcnt,user.inviter=e.inviter,user.age=e.age,user.isAdmin=e.isAdmin,$(".user").show(),$("#signout-btn").show(),$("#username").html(user.username),$("#userId").html(user.userId),$("#age").html(user.age),$("#email").html(user.email),$("#inviteCode").html(user.invitationCode),$("#inviteBy").html(user.inviter),$("#cnt").html(user.cnt),$("#tagged").html(user.tagcnt),$("#deleted").html(user.delcnt),$("#chcnt").html(user.chcnt),user.isAdmin?$(".only-admin").show():$(".only-admin").hide()},error:function(e){$(".user").hide(),$(".login").show(),$("#signout-btn").hide()}});